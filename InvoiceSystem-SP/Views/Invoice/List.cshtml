@model List<InvoiceSystem_SP.ViewModels.InvoiceListViewModel>

@{
    ViewBag.Title = "Invoice List";
}

<h2>Invoice List</h2>

@using (Html.BeginForm("SearchInvoices", "Invoice", FormMethod.Post, new { @class = "form-inline", role = "search" }))
{
    @Html.AntiForgeryToken()
    <div class="form-group">
        <label for="searchCustomer">Search by Customer Name/Invoice ID:</label>
        <input type="text" class="form-control" name="searchCustomer" value="@ViewBag.CurrentSearch" placeholder="Customer Name or ID" />
    </div>
    <button type="submit" class="btn btn-primary">Search</button>
    @Html.ActionLink("Clear Filter", "List", null, new { @class = "btn btn-default" })
}

<hr />

@if (Model != null && Model.Count > 0)
{
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>@Html.DisplayNameFor(model => model.First().InvoiceID)</th>
                <th>@Html.DisplayNameFor(model => model.First().InvoiceDate)</th>
                <th>@Html.DisplayNameFor(model => model.First().CustomerName)</th>
                <th>@Html.DisplayNameFor(model => model.First().TotalAmount)</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>@Html.DisplayFor(modelItem => item.InvoiceID)</td>
                    <td>@item.InvoiceDate.ToShortDateString()</td>
                    <td>@Html.DisplayFor(modelItem => item.CustomerName)</td>
                    <td>@Html.DisplayFor(modelItem => item.TotalAmount)</td>
                    <td>
                        @Html.ActionLink("View Report", "ViewInvoice", new { id = item.InvoiceID }, new { @class = "btn btn-sm btn-success" })
                    </td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <div class="alert alert-warning">
        No invoices found.
        @if (!string.IsNullOrEmpty(ViewBag.CurrentSearch))
        {
            <span>(Filter: <strong>@ViewBag.CurrentSearch</strong>)</span>
        }
    </div>
}